大数据分析 数据倾斜问题研究

高频key引起
              空值/异常值                    高频值
join          数据清洗                       key值分裂 map端join
groupby                                      map端聚合(hive.map.aggr) 两次聚合(hive.groupby.skewindata, 跟狗屎一样)

单机引起
count(distinct) (1)map端聚合 两次聚合不能完全解决问题
                (2)reduce单机处理较慢 配合distinct: select count(*) from (select distinct(col) from table); 	 	


更加高级的优化
set hive.optimize.skewjoin = true; 高频key提取出来用map-side-join


学霸装B：
hive.groupby.skewindata对count(distinct)的改进
