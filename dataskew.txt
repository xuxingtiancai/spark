大数据分析 数据倾斜问题研究

高频key引起
              空值/异常值                    高频值
join          数据清洗                       key值分裂 map端join
groupby                                      map端聚合(hive.map.aggr) 两次聚合(hive.groupby.skewindata)

单机引起
count(distinct) (1)map端聚合 两次聚合不能完全解决问题
                (2)reduce单机处理较慢 配合distinct: select count(*) from (select distinct(col) from table); 	 	
